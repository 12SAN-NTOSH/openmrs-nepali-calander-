"use strict";(globalThis.webpackChunk_openmrs_esm_framework=globalThis.webpackChunk_openmrs_esm_framework||[]).push([[126],{4126:(e,r,t)=>{t.r(r),t.d(r,{SWRConfig:()=>l,default:()=>d,mutate:()=>a.JG,preload:()=>a.MA,unstable_serialize:()=>i,useSWRConfig:()=>a.kY});var n=t(5776),s=t(1374),a=t(56);const i=e=>(0,a.qC)(e)[0],u=n.use||(e=>{if("pending"===e.status)throw e;if("fulfilled"===e.status)return e.value;throw"rejected"===e.status?e.reason:(e.status="pending",e.then((r=>{e.status="fulfilled",e.value=r}),(r=>{e.status="rejected",e.reason=r})),e)}),o={dedupe:!0},l=a.$l.defineProperty(a.J$,"defaultValue",{value:a.u_}),d=(0,a.s6)(((e,r,t)=>{const{cache:i,compare:l,suspense:d,fallbackData:c,revalidateOnMount:f,revalidateIfStale:g,refreshInterval:E,refreshWhenHidden:h,refreshWhenOffline:R,keepPreviousData:V}=t,[T,_,k,m]=a.DY.get(i),[p,w]=(0,a.qC)(e),b=(0,n.useRef)(!1),L=(0,n.useRef)(!1),C=(0,n.useRef)(p),v=(0,n.useRef)(r),O=(0,n.useRef)(t),S=()=>O.current,D=()=>S().isVisible()&&S().isOnline(),[I,N,y,j]=(0,a.JN)(i,p),P=(0,n.useRef)({}).current,A=(0,a.o8)(c)?t.fallback[p]:c,W=(e,r)=>{for(const t in P){const n=t;if("data"===n){if(!l(e[n],r[n])){if(!(0,a.o8)(e[n]))return!1;if(!l(z,r[n]))return!1}}else if(r[n]!==e[n])return!1}return!0},M=(0,n.useMemo)((()=>{const e=!!p&&!!r&&((0,a.o8)(f)?!S().isPaused()&&!d&&(!!(0,a.o8)(g)||g):f),t=r=>{const t=(0,a.PM)(r);return delete t._k,e?{isValidating:!0,isLoading:!0,...t}:t},n=I(),s=j(),i=t(n),u=n===s?i:t(s);let o=i;return[()=>{const e=t(I());return W(e,o)?(o.data=e.data,o.isLoading=e.isLoading,o.isValidating=e.isValidating,o.error=e.error,o):(o=e,e)},()=>u]}),[i,p]),q=(0,s.useSyncExternalStore)((0,n.useCallback)((e=>y(p,((r,t)=>{W(t,r)||e()}))),[i,p]),M[0],M[1]),F=!b.current,J=T[p]&&T[p].length>0,U=q.data,Y=(0,a.o8)(U)?A:U,$=q.error,x=(0,n.useRef)(Y),z=V?(0,a.o8)(U)?x.current:U:Y,B=!(J&&!(0,a.o8)($))&&(F&&!(0,a.o8)(f)?f:!S().isPaused()&&(d?!(0,a.o8)(Y)&&g:(0,a.o8)(Y)||g)),G=!!(p&&r&&F&&B),H=(0,a.o8)(q.isValidating)?G:q.isValidating,K=(0,a.o8)(q.isLoading)?G:q.isLoading,Q=(0,n.useCallback)((async e=>{const r=v.current;if(!p||!r||L.current||S().isPaused())return!1;let n,s,i=!0;const u=e||{},o=!k[p]||!u.dedupe,d=()=>a.w6?!L.current&&p===C.current&&b.current:p===C.current,c={isValidating:!1,isLoading:!1},f=()=>{N(c)},g=()=>{const e=k[p];e&&e[1]===s&&delete k[p]},E={isValidating:!0};(0,a.o8)(I().data)&&(E.isLoading=!0);try{if(o&&(N(E),t.loadingTimeout&&(0,a.o8)(I().data)&&setTimeout((()=>{i&&d()&&S().onLoadingSlow(p,t)}),t.loadingTimeout),k[p]=[r(w),(0,a.u3)()]),[n,s]=k[p],n=await n,o&&setTimeout(g,t.dedupingInterval),!k[p]||k[p][1]!==s)return o&&d()&&S().onDiscarded(p),!1;c.error=a.i_;const e=_[p];if(!(0,a.o8)(e)&&(s<=e[0]||s<=e[1]||0===e[1]))return f(),o&&d()&&S().onDiscarded(p),!1;const u=I().data;c.data=l(u,n)?u:n,o&&d()&&S().onSuccess(n,p,t)}catch(e){g();const r=S(),{shouldRetryOnError:t}=r;r.isPaused()||(c.error=e,o&&d()&&(r.onError(e,p,r),(!0===t||(0,a.mf)(t)&&t(e))&&D()&&r.onErrorRetry(e,p,r,(e=>{const r=T[p];r&&r[0]&&r[0](a.sj.ERROR_REVALIDATE_EVENT,e)}),{retryCount:(u.retryCount||0)+1,dedupe:!0})))}return i=!1,f(),!0}),[p,i]),X=(0,n.useCallback)(((...e)=>(0,a.BN)(i,C.current,...e)),[]);if((0,a.LI)((()=>{v.current=r,O.current=t,(0,a.o8)(U)||(x.current=U)})),(0,a.LI)((()=>{if(!p)return;const e=Q.bind(a.i_,o);let r=0;const t=(0,a.ko)(p,T,((t,n={})=>{if(t==a.sj.FOCUS_EVENT){const t=Date.now();S().revalidateOnFocus&&t>r&&D()&&(r=t+S().focusThrottleInterval,e())}else if(t==a.sj.RECONNECT_EVENT)S().revalidateOnReconnect&&D()&&e();else{if(t==a.sj.MUTATE_EVENT)return Q();if(t==a.sj.ERROR_REVALIDATE_EVENT)return Q(n)}}));return L.current=!1,C.current=p,b.current=!0,N({_k:w}),B&&((0,a.o8)(Y)||a.W6?e():(0,a.kw)(e)),()=>{L.current=!0,t()}}),[p]),(0,a.LI)((()=>{let e;function r(){const r=(0,a.mf)(E)?E(I().data):E;r&&-1!==e&&(e=setTimeout(t,r))}function t(){I().error||!h&&!S().isVisible()||!R&&!S().isOnline()?r():Q(o).then(r)}return r(),()=>{e&&(clearTimeout(e),e=-1)}}),[E,h,R,p]),(0,n.useDebugValue)(z),d&&(0,a.o8)(Y)&&p){if(!a.w6&&a.W6)throw new Error("Fallback data is required when using suspense in SSR.");v.current=r,O.current=t,L.current=!1;const e=m[p];if(!(0,a.o8)(e)){const r=X(e);u(r)}if(!(0,a.o8)($))throw $;{const e=Q(o);(0,a.o8)(z)||(e.status="fulfilled",e.value=!0),u(e)}}return{mutate:X,get data(){return P.data=!0,z},get error(){return P.error=!0,$},get isValidating(){return P.isValidating=!0,H},get isLoading(){return P.isLoading=!0,K}}}))}}]);
//# sourceMappingURL=126.openmrs-esm-framework.js.map