(self.webpackChunk_openmrs_esm_app_shell=self.webpackChunk_openmrs_esm_app_shell||[]).push([[199],{79023:(e,t,n)=>{var r={"./am.json":[83878,878],"./ar.json":[16283,283],"./en.json":[90783,783],"./es.json":[34073,73],"./fr.json":[77595,595],"./he.json":[44762,762],"./km.json":[52463,463],"./zh.json":[57625,353],"./zh_CN.json":[13460,460]};function o(e){if(!n.o(r,e))return Promise.resolve().then((()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=r[e],o=t[0];return n.e(t[1]).then((()=>n.t(o,19)))}o.keys=()=>Object.keys(r),o.id=79023,e.exports=o},53199:(e,t,n)=>{"use strict";n.r(t),n.d(t,{run:()=>q});var r=n(12158),o=n(78478),i=n(84588),a=n.n(i),c=n(34259),s=n(62680),l=n(21531);function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function f(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,c=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){c=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(c)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t,n){if("function"!=typeof e.importTranslation)throw Error("Module ".concat(t," does not export an importTranslation function"));var r,o,i=e.importTranslation("./".concat(n,".json"));if(r=i,!(null!=(o=Promise)&&"undefined"!=typeof Symbol&&o[Symbol.hasInstance]?o[Symbol.hasInstance](r):r instanceof o))throw Error("Module ".concat(t," exports an importTranslation function that does not return a promise. Did you forget to set require.context mode to 'lazy'?"));return i}(0,o.registerTranslationNamespace)("core");var p=n(2641);function h(){var e=(0,o.getCurrentUser)().subscribe((function(t){var n;t.authenticated&&(null==e||e.unsubscribe(),(n=window.installedModules.reduce((function(e,t){var n;return(null===(n=t[1])||void 0===n?void 0:n.optionalBackendDependencies)&&Object.entries(t[1].optionalBackendDependencies).forEach((function(n){var r,o,i,a=n[1];"string"!=typeof a&&("object"==typeof a.feature&&a.feature&&(null===(r=a.feature.flagName)||void 0===r?void 0:r.length)>0&&(null===(o=a.feature.label)||void 0===o?void 0:o.length)>0&&(null===(i=a.feature.description)||void 0===i?void 0:i.length)>0?e.set(n[0],{version:a.version,feature:a.feature}):console.warn("Feature flag descriptor for ".concat(t[0]," does not match expected type. Feature flags must define a 'flagName', 'label', and 'description'")))})),e}),new Map)).size>0&&(0,o.openmrsFetch)("".concat(o.restBaseUrl,"/module?v=custom:(uuid,version)")).then((function(e){var t;(null!==(t=e.data.results)&&void 0!==t?t:[]).forEach((function(e){if(n.has(e.uuid)){var t=n.get(e.uuid);t&&(0,p.satisfies)(e.version,t.version)&&((0,o.registerFeatureFlag)(t.feature.flagName,t.feature.label,t.feature.description),(0,o.setFeatureFlag)(t.feature.flagName,!0))}}))})).catch((function(){})))}));return Promise.resolve()}var m=n(57011),v="@openmrs/esm-app-shell";function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function b(e,t,n,r,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function g(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){b(i,r,o,a,c,"next",e)}function c(e){b(i,r,o,a,c,"throw",e)}a(void 0)}))}}function w(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function S(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}}var O=Symbol("openmrs_registration_promises");function j(){return j=g((function(){var e,t,n,r,i,a,c,s,l;return S(this,(function(u){switch(u.label){case 0:for(e=document.querySelectorAll("script[type='openmrs-routes']"),t=[],n=0;n<e.length;n++)t.push(function(){var e=g((function(e){var t,n,r;return S(this,(function(i){switch(i.label){case 0:t=void 0,i.label=1;case 1:return i.trys.push([1,5,,6]),e.textContent?(t=JSON.parse(e.textContent),[3,4]):[3,2];case 2:return e.src?[4,(0,o.openmrsFetch)(e.src)]:[3,4];case 3:t=i.sent().data,i.label=4;case 4:return[3,6];case 5:return n=i.sent(),console.error("Caught error while loading routes from ".concat(null!==(r=e.src)&&void 0!==r?r:"JSON script tag content"),n),[2,{}];case 6:return[2,Promise.resolve(null!=t?t:{})]}}))}));return function(t){return e.apply(this,arguments)}}()(e.item(n)));if((0,o.canAccessStorage)())for(r=function(e){var n=i.key(e);if(null==n?void 0:n.startsWith(o.localStorageRoutesPrefix)){var r=i.getItem(n);if(r)try{var a=JSON.parse(r);(0,o.isOpenmrsAppRoutes)(a)?t.push(Promise.resolve(w({},n.slice(o.localStorageRoutesPrefix.length),a))):"string"==typeof a&&a.startsWith("http")?t.push((0,o.openmrsFetch)(a).then((function(e){return(0,o.isOpenmrsAppRoutes)(e.data)?Promise.resolve(w({},n.slice(o.localStorageRoutesPrefix.length),e.data)):Promise.reject("".concat(a," did not resolve to a valid OpenmrsAppRoutes JSON object"))})).catch((function(e){throw console.warn("Failed to fetch route overrides for ".concat(n.slice(o.localStorageRoutesPrefix.length)),e),e}))):console.warn("Route override for ".concat(n.slice(o.localStorageRoutesPrefix.length)," could not be handled as it was neither a JSON object nor a URL string"),r)}catch(e){console.error("Error parsing local route override for ".concat(n),e)}}},i=window.localStorage,a=0;a<i.length;a++)r(a);return[4,Promise.allSettled(t)];case 1:return c=u.sent().filter((function(e){return"fulfilled"===e.status})).map((function(e){return e.value})).filter(o.isOpenmrsRoutes).reduce((function(e,t){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){w(e,t,n[t])}))}return e}({},e,t)}),{}),s=[],l=Object.entries(c).map((f=g((function(e){var t,n,r;return S(this,(function(i){return t=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,c=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){c=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(c)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?y(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(e,2),n=t[0],r=t[1],s.push([n,r]),(0,o.registerApp)(n,r),[2]}))})),function(e){return f.apply(this,arguments)})),window[O]=Promise.all(l),window.installedModules=s,[2]}var f}))})),j.apply(this,arguments)}function k(e){return x.apply(this,arguments)}function x(){return(x=g((function(e){var t,n,r,i,a,c;return S(this,(function(s){t=!0,n=!1,r=void 0;try{for(i=e[Symbol.iterator]();!(t=(a=i.next()).done);t=!0)c=a.value,(0,o.provide)(c.value,c.name)}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}return[2]}))}))).apply(this,arguments)}function A(){if(window.offlineEnabled){var e=navigator.onLine;(0,r.triggerAppChange)(),(0,o.dispatchConnectivityChanged)(e),(0,o.showToast)({critical:!0,description:"Connection: ".concat(e?"online":"offline"),title:"App",kind:e?"success":"warning"})}}function P(){return(window.i18next=a()||i,new MutationObserver((function(){window.i18next.changeLanguage(void 0).catch((function(e){return console.error("i18next failed to re-detect language",e)}))})).observe(document.documentElement,{attributeFilter:["lang"],attributes:!0}),window.i18next.on("languageChanged",(function(){document.documentElement.setAttribute("dir",window.i18next.dir())})),window.i18next.use(c.Z).use({type:"backend",init:function(){},read:function(e,t,r){"translation"===t?r(Error("can't handle translation namespace"),null):void 0===t||void 0===e?r(Error(),null):"core"===t?Promise.all([n(79023)("./".concat(e,".json")),(0,o.getTranslationOverrides)(t)]).then((function(t){var n,o=f(t,2),i=o[0],a=o[1],c=null!==(n=null==i?void 0:i.default)&&void 0!==n?n:{};e in a&&(c=(0,l.Z)(c,a[e])),r(null,c)})).catch((function(e){r(e,null)})):(0,o.importDynamic)(t).then((function(n){return Promise.all([d(n,t,e),(0,o.getTranslationOverrides)(t)])})).then((function(t){var n=f(t,2),o=n[0],i=n[1],a=null!=o?o:{};e in i&&(a=(0,l.Z)(a,i[e])),r(null,a)})).catch((function(e){r(e,null)}))}}).use(s.initReactI18next).init({detection:{order:["querystring","htmlTag","localStorage","navigator"],lookupQuerystring:"lang"},fallbackLng:"en",nsSeparator:!1})).catch((function(e){return console.error("Failed to initialize translations",e)})).then((function(){return(0,r.start)()}))}function C(e){console.error(e),function(e){var t=document.querySelector("#app-error");if(t){var n=t.content.cloneNode(!0),r=n.querySelector('[data-var="message"]');if(r&&(r.textContent=(null==e?void 0:e.message)||"No additional information available."),localStorage.getItem("openmrs:devtools")&&Object.keys(localStorage).some((function(e){return e.startsWith("import-map-override:")}))){var o=null==n?void 0:n.querySelector("#buttons");if(o){var i=document.createElement("button");i.className="cds--btn",i.innerHTML="Clear dev overrides",i.onclick=N,o.appendChild(i)}}document.body.appendChild(n)}}(e)}function N(){var e=!0,t=!1,n=void 0;try{for(var r,o=Object.keys(localStorage)[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){var i=r.value;i.startsWith("import-map-override:")&&!["import-map-override:react","import-map-override:react-dom"].includes(i)&&localStorage.removeItem(i)}}catch(e){t=!0,n=e}finally{try{e||null==o.return||o.return()}finally{if(t)throw n}}location.reload()}function E(){return T.apply(this,arguments)}function T(){return(T=g((function(){var e;return S(this,(function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),[4,(0,o.registerOmrsServiceWorker)("".concat(window.getOpenmrsSpaBase(),"service-worker.js"))];case 1:return t.sent(),[4,(0,o.activateOfflineCapability)()];case 2:return t.sent(),3e5,n=null,r=function(e,t){var r=!n||(new Date).getTime()-n.getTime()>3e5;t&&e&&r&&(n=new Date,(0,o.dispatchPrecacheStaticDependencies)())},i=!1,a=!1,(0,o.getCurrentUser)({includeAuthStatus:!1}).subscribe((function(e){r(i,a=!!e)})),(0,o.subscribeConnectivity)((function(e){var t=e.online;i=t,r(t,a)})),[3,4];case 3:return e=t.sent(),console.error("Error while setting up offline mode.",e),(0,o.showNotification)({kind:"error",title:"Offline Setup Error",description:e.message}),[3,4];case 4:return[2]}var n,r,i,a}))}))).apply(this,arguments)}function M(){return F.apply(this,arguments)}function F(){return(F=g((function(){var e;return S(this,(function(t){switch(t.label){case 0:return[4,R()];case 1:return t.sent(),e=new URL("".concat(window.openmrsBase).concat(o.restBaseUrl,"/session"),window.location.origin).href,[4,(0,o.messageOmrsServiceWorker)({type:"registerDynamicRoute",url:e,strategy:"network-first"})];case 2:return t.sent(),[4,(0,o.openmrsFetch)("".concat(o.restBaseUrl,"/session")).catch((function(e){return console.warn("Failed to precache the user session data from the app shell. MFs depending on this data may run into problems while offline.",e)}))];case 3:return t.sent(),[2]}}))}))).apply(this,arguments)}function R(){return I.apply(this,arguments)}function I(){return(I=g((function(){var e;return S(this,(function(t){switch(t.label){case 0:return[4,window.importMapOverrides.getCurrentPageMap()];case 1:return e=t.sent(),[4,(0,o.messageOmrsServiceWorker)({type:"onImportMapChanged",importMap:e})];case 2:return t.sent(),[2]}}))}))).apply(this,arguments)}function L(){window.addEventListener("offline",A),window.addEventListener("online",A)}function _(){(0,o.subscribeConnectivity)((function(e){var t=e.online,n=document.querySelector("body");t?n.classList.remove("omrs-offline"):n.classList.add("omrs-offline")}))}function q(e){var t=window.offlineEnabled,r=(0,o.renderLoadingSpinner)(document.body),i=function(e){var t=Promise.all(e.map((function(e){var t=(0,o.interpolateUrl)(e);return fetch(t).then((function(e){return e.json()})).then((function(t){return{name:e,value:t}})).catch((function(t){return console.error('Loading the config from "'.concat(e,'" failed.'),t),{name:e,value:{}}}))})));return function(){return t.then(k)}}(e);return(0,o.integrateBreakpoints)(),(0,o.renderToasts)(document.querySelector(".omrs-toasts-container")),(0,o.setupModals)(document.querySelector(".omrs-modals-container")),(0,o.renderInlineNotifications)(document.querySelector(".omrs-inline-notifications-container")),(0,o.renderActionableNotifications)(document.querySelector(".omrs-actionable-notifications-container")),(0,o.renderSnackbars)(document.querySelector(".omrs-snackbars-container")),(0,o.subscribeNotificationShown)(o.showNotification),(0,o.subscribeActionableNotificationShown)(o.showActionableNotification),(0,o.subscribeToastShown)(o.showToast),(0,o.subscribeSnackbarShown)(o.showSnackbar),(0,o.subscribePrecacheStaticDependencies)(M),(0,o.setupApiModule)(),(0,o.setupHistory)(),function(){var e,t=(e={featureName:"app-shell",moduleName:v},[{name:"breadcrumbs-widget",slot:"breadcrumbs-slot",load:(0,m.getAsyncLifecycle)((function(){return Promise.all([n.e(776),n.e(6),n.e(954)]).then(n.bind(n,11954))}),e),online:!0,offline:!0}]),r=!0,i=!1,a=void 0;try{for(var c,s=t[Symbol.iterator]();!(r=(c=s.next()).done);r=!0){var l=c.value;(0,o.tryRegisterExtension)(v,l)}}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}}(),function(){return j.apply(this,arguments)}().then(o.finishRegisteringAllApps).then(t?_:void 0).then(t?L:void 0).then(i).then(P).catch(C).then(r).then(t?E:void 0).then(h)}}}]);